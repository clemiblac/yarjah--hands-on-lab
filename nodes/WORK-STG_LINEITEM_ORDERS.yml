fileVersion: 1
id: b7d4d6f0-67cc-4979-aef4-dd231f70e1c6
name: STG_LINEITEM_ORDERS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: WORK
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f79b2220-d8e6-4a86-9762-2cea3891dc03
          stepCounter: b7d4d6f0-67cc-4979-aef4-dd231f70e1c6
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: PS_AVAILQTY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 435c4c9a-d9df-4a8f-ac76-cf596c15d18f
                stepCounter: 73297789-8c61-493f-8c5b-8efd4613df0a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 558ab401-3d03-4148-aafb-32e6d827aa8a
          stepCounter: b7d4d6f0-67cc-4979-aef4-dd231f70e1c6
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: PS_SUPPLYCOST
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e975405a-b6c1-4dae-ba55-d54b7d0c0393
                stepCounter: 73297789-8c61-493f-8c5b-8efd4613df0a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c0f6056b-7bc1-4c6d-9042-49c1bb4b9b4a
          stepCounter: b7d4d6f0-67cc-4979-aef4-dd231f70e1c6
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: O_CUSTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 21d78503-2667-4c99-a046-5ccdbb52342b
                stepCounter: 3e96cd3d-139d-4266-b107-886fcbe41dce
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e826eab8-9756-4004-a7aa-e6daf5f111f9
          stepCounter: b7d4d6f0-67cc-4979-aef4-dd231f70e1c6
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: L_SUPPKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 41cfd2e0-5502-4799-98a1-9633fd5b82e0
                stepCounter: c88432b8-6de4-4489-85f6-54114ddb723f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2d7b3fba-b801-425e-8a35-d6ef0b765e27
          stepCounter: b7d4d6f0-67cc-4979-aef4-dd231f70e1c6
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: L_PARTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 64854359-028e-4a86-97e6-9e61b3d80fba
                stepCounter: c88432b8-6de4-4489-85f6-54114ddb723f
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 7ad832ad-d6e1-4b4c-bd3d-f57d2789648d
          stepCounter: b7d4d6f0-67cc-4979-aef4-dd231f70e1c6
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: DAYS TO SHIP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |+
              DATEDIFF('DAY',"STG_ORDERS"."O_ORDERDATE","STG_LINEITEM"."L_SHIPDATE")

        systemColumnType: None
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d3e45a9b-2354-4c60-8c01-eb6d4b7fc825
          stepCounter: b7d4d6f0-67cc-4979-aef4-dd231f70e1c6
        config: {}
        dataType: VARCHAR(44)
        description: ""
        name: L_COMMENT
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1b109e9c-3755-476f-bc6b-7c0971e2ba6a
                stepCounter: c88432b8-6de4-4489-85f6-54114ddb723f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f725ee2b-7f8f-4475-892b-d6bd74700149
          stepCounter: b7d4d6f0-67cc-4979-aef4-dd231f70e1c6
        config: {}
        dataType: DATE
        description: ""
        name: L_COMMITDATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e9bfcf86-cc86-4e69-b8c1-864dc92c17bf
                stepCounter: c88432b8-6de4-4489-85f6-54114ddb723f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 428d944b-d8ca-4f9e-96fd-fa535ce13e42
          stepCounter: b7d4d6f0-67cc-4979-aef4-dd231f70e1c6
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: L_DISCOUNT
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b018065b-075e-4df1-976c-aabbce682158
                stepCounter: c88432b8-6de4-4489-85f6-54114ddb723f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3bfe4e0a-7a99-4652-bd10-24e07e72d0f7
          stepCounter: b7d4d6f0-67cc-4979-aef4-dd231f70e1c6
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: L_EXTENDEDPRICE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f7a5b1c6-32c5-4999-ba15-f79b9b2d7903
                stepCounter: c88432b8-6de4-4489-85f6-54114ddb723f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8e863c17-10a7-4c37-ae47-bad211c9366d
          stepCounter: b7d4d6f0-67cc-4979-aef4-dd231f70e1c6
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: L_LINENUMBER
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 54b2fbea-67c4-4fed-bd31-5e2c55e188c9
                stepCounter: c88432b8-6de4-4489-85f6-54114ddb723f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 97b1302f-bc5e-4879-9612-feaa78a2b3c7
          stepCounter: b7d4d6f0-67cc-4979-aef4-dd231f70e1c6
        config: {}
        dataType: VARCHAR(1)
        description: ""
        name: L_LINESTATUS
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c152234f-061e-4585-ac97-d805dc52bb09
                stepCounter: c88432b8-6de4-4489-85f6-54114ddb723f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4be4bf38-d567-403a-b591-95e10f374d55
          stepCounter: b7d4d6f0-67cc-4979-aef4-dd231f70e1c6
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: L_ORDERKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7dcd9d82-e14f-44c9-8341-c3c7f597343d
                stepCounter: c88432b8-6de4-4489-85f6-54114ddb723f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 315196d6-5ab9-4b1f-b2fd-43d74d48ecef
          stepCounter: b7d4d6f0-67cc-4979-aef4-dd231f70e1c6
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: L_QUANTITY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a6dc5064-973b-40fb-aa87-9903c86ec63e
                stepCounter: c88432b8-6de4-4489-85f6-54114ddb723f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 06b60786-6788-4f06-9532-5872de721d48
          stepCounter: b7d4d6f0-67cc-4979-aef4-dd231f70e1c6
        config: {}
        dataType: DATE
        description: ""
        name: L_RECEIPTDATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ce1d2a25-a10b-4b85-86e0-0347d9d64ed7
                stepCounter: c88432b8-6de4-4489-85f6-54114ddb723f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d1ffcd2e-631f-4cef-b54e-976aa6b72455
          stepCounter: b7d4d6f0-67cc-4979-aef4-dd231f70e1c6
        config: {}
        dataType: VARCHAR(1)
        description: ""
        name: L_RETURNFLAG
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3f05b888-af68-48a1-8861-9f400107d0a5
                stepCounter: c88432b8-6de4-4489-85f6-54114ddb723f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 924c1d2c-9f28-48d3-8629-59dc67ea93d8
          stepCounter: b7d4d6f0-67cc-4979-aef4-dd231f70e1c6
        config: {}
        dataType: DATE
        description: ""
        name: L_SHIPDATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ea6c5a18-117b-4887-8bbf-120750f95d19
                stepCounter: c88432b8-6de4-4489-85f6-54114ddb723f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 69770183-3318-46dc-b80d-9ce5b7cabfac
          stepCounter: b7d4d6f0-67cc-4979-aef4-dd231f70e1c6
        config: {}
        dataType: VARCHAR(25)
        description: ""
        name: L_SHIPINSTRUCT
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 622f2716-d3c7-4f67-88fe-9af4d00a8fb1
                stepCounter: c88432b8-6de4-4489-85f6-54114ddb723f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b048d811-06a6-42c3-8f12-8e2fc8fb3591
          stepCounter: b7d4d6f0-67cc-4979-aef4-dd231f70e1c6
        config: {}
        dataType: VARCHAR(10)
        description: ""
        name: L_SHIPMODE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9aa5974f-da9f-48eb-b531-8164a82b9b8f
                stepCounter: c88432b8-6de4-4489-85f6-54114ddb723f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cece0ad5-b805-4400-b13e-18f9217488a6
          stepCounter: b7d4d6f0-67cc-4979-aef4-dd231f70e1c6
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: L_TAX
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fae2186a-8824-423b-8fd2-7c2d75142f5d
                stepCounter: c88432b8-6de4-4489-85f6-54114ddb723f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 79ed050f-0acf-4fac-aca0-cfae79048bb8
          stepCounter: b7d4d6f0-67cc-4979-aef4-dd231f70e1c6
        config: {}
        dataType: VARCHAR(15)
        description: ""
        name: O_CLERK
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 95e1cef8-4d3b-4606-8336-ee22c61baede
                stepCounter: 3e96cd3d-139d-4266-b107-886fcbe41dce
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 83699806-d79c-451a-b25e-a0208b77002d
          stepCounter: b7d4d6f0-67cc-4979-aef4-dd231f70e1c6
        config: {}
        dataType: VARCHAR(79)
        description: ""
        name: O_COMMENT
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2b913a61-6b62-4453-8b44-aeefcf36b3d4
                stepCounter: 3e96cd3d-139d-4266-b107-886fcbe41dce
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7a1c394c-d1cd-4a44-bb3d-d8e215c47560
          stepCounter: b7d4d6f0-67cc-4979-aef4-dd231f70e1c6
        config: {}
        dataType: DATE
        description: ""
        name: O_ORDERDATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 95b57e24-bc79-491b-8297-76c769867eb0
                stepCounter: 3e96cd3d-139d-4266-b107-886fcbe41dce
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 74809de7-1fc9-4005-bc4b-4352af599237
          stepCounter: b7d4d6f0-67cc-4979-aef4-dd231f70e1c6
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: O_ORDERKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 13bddd09-6a83-4476-bf6a-d3ffb6334d51
                stepCounter: 3e96cd3d-139d-4266-b107-886fcbe41dce
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 37e434a7-91cd-41c2-a7e6-7c8b1c115ac6
          stepCounter: b7d4d6f0-67cc-4979-aef4-dd231f70e1c6
        config: {}
        dataType: VARCHAR(15)
        description: ""
        name: O_ORDERPRIORITY_DESC
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 27fa2b0a-c143-4d09-9ba2-356fb3598282
                stepCounter: 3e96cd3d-139d-4266-b107-886fcbe41dce
            transform: SPLIT_PART("STG_ORDERS"."O_ORDERPRIORITY", '-', 2 )
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b7c4dd62-ab60-4eda-afbf-9a0fd4b35946
          stepCounter: b7d4d6f0-67cc-4979-aef4-dd231f70e1c6
        config: {}
        dataType: VARCHAR(15)
        description: ""
        name: O_ORDERPRIORITY_NUM
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 27fa2b0a-c143-4d09-9ba2-356fb3598282
                stepCounter: 3e96cd3d-139d-4266-b107-886fcbe41dce
            transform: SPLIT_PART("STG_ORDERS"."O_ORDERPRIORITY", '-', 1 )
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39bc1159-d3b6-4bfe-8288-4b57ea141ff2
          stepCounter: b7d4d6f0-67cc-4979-aef4-dd231f70e1c6
        config: {}
        dataType: VARCHAR(1)
        description: ""
        name: O_ORDERSTATUS
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 527702d5-36d8-4faa-8baa-0a3aa7f1ac93
                stepCounter: 3e96cd3d-139d-4266-b107-886fcbe41dce
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1951edd5-24a6-48f6-912e-a98972107291
          stepCounter: b7d4d6f0-67cc-4979-aef4-dd231f70e1c6
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: O_SHIPPRIORITY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 36376a60-7050-4d63-94d0-9e976a0f8b5e
                stepCounter: 3e96cd3d-139d-4266-b107-886fcbe41dce
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 62672779-5861-4558-8a1d-a6432a9a6260
          stepCounter: b7d4d6f0-67cc-4979-aef4-dd231f70e1c6
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: O_TOTALPRICE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 56017243-07e7-486f-b2b5-551292962096
                stepCounter: 3e96cd3d-139d-4266-b107-886fcbe41dce
            transform: ""
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STG_LINEITEM: c88432b8-6de4-4489-85f6-54114ddb723f
          STG_ORDERS: 3e96cd3d-139d-4266-b107-886fcbe41dce
          STG_PARTSUPP: 73297789-8c61-493f-8c5b-8efd4613df0a
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: WORK
            nodeName: STG_LINEITEM
          - locationName: WORK
            nodeName: STG_ORDERS
          - locationName: WORK
            nodeName: STG_PARTSUPP
        join:
          joinCondition: |-
            FROM {{ ref('WORK', 'STG_ORDERS') }} "STG_ORDERS"

            INNER JOIN {{ ref('WORK', 'STG_LINEITEM') }} "STG_LINEITEM"

            ON "STG_ORDERS"."O_ORDERKEY" = "STG_LINEITEM"."L_ORDERKEY"

            INNER JOIN {{ ref('WORK', 'STG_PARTSUPP') }} "STG_PARTSUPP"

            ON "STG_LINEITEM"."L_PARTKEY" = "STG_PARTSUPP"."PS_PARTKEY" AND "STG_LINEITEM"."L_SUPPKEY" = "STG_PARTSUPP"."PS_SUPPKEY"
        name: STG_LINEITEM_ORDERS
        noLinkRefs: []
  name: STG_LINEITEM_ORDERS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
